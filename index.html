<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Smart Menu Planner</title>
    <script crossorigin src="https://unpkg.com/react@18/umd/react.production.min.js"></script>
    <script crossorigin src="https://unpkg.com/react-dom@18/umd/react-dom.production.min.js"></script>
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
    <script src="https://cdn.tailwindcss.com"></script>
    <script>
        // Lucide icons as simple objects to avoid external dependency issues
        const Icons = {
            Plus: () => React.createElement('svg', { width: 16, height: 16, viewBox: '0 0 24 24', fill: 'none', stroke: 'currentColor', strokeWidth: 2 }, 
                React.createElement('line', { x1: 12, y1: 5, x2: 12, y2: 19 }),
                React.createElement('line', { x1: 5, y1: 12, x2: 19, y2: 12 })
            ),
            X: () => React.createElement('svg', { width: 16, height: 16, viewBox: '0 0 24 24', fill: 'none', stroke: 'currentColor', strokeWidth: 2 },
                React.createElement('line', { x1: 18, y1: 6, x2: 6, y2: 18 }),
                React.createElement('line', { x1: 6, y1: 6, x2: 18, y2: 18 })
            ),
            DollarSign: () => React.createElement('svg', { width: 20, height: 20, viewBox: '0 0 24 24', fill: 'none', stroke: 'currentColor', strokeWidth: 2 },
                React.createElement('line', { x1: 12, y1: 1, x2: 12, y2: 23 }),
                React.createElement('path', { d: 's 17 5 c 0 0 0 7 0 3 0 5.5 0 5.5 0 0z' }),
                React.createElement('path', { d: 's 2 5 c 0 0 0 7 0 3 0 5.5 0 5.5 0 0z' })
            ),
            ShoppingCart: () => React.createElement('svg', { width: 20, height: 20, viewBox: '0 0 24 24', fill: 'none', stroke: 'currentColor', strokeWidth: 2 },
                React.createElement('circle', { cx: 9, cy: 21, r: 1 }),
                React.createElement('circle', { cx: 20, cy: 21, r: 1 }),
                React.createElement('path', { d: 'm1 1h4l2.68 13.39a2 2 0 0 0 2 1.61h9.72a2 2 0 0 0 2-1.61L23 6H6' })
            ),
            Calendar: () => React.createElement('svg', { width: 20, height: 20, viewBox: '0 0 24 24', fill: 'none', stroke: 'currentColor', strokeWidth: 2 },
                React.createElement('rect', { x: 3, y: 4, width: 18, height: 18, rx: 2, ry: 2 }),
                React.createElement('line', { x1: 16, y1: 2, x2: 16, y2: 6 }),
                React.createElement('line', { x1: 8, y1: 2, x2: 8, y2: 6 }),
                React.createElement('line', { x1: 3, y1: 10, x2: 21, y2: 10 })
            ),
            Filter: () => React.createElement('svg', { width: 20, height: 20, viewBox: '0 0 24 24', fill: 'none', stroke: 'currentColor', strokeWidth: 2 },
                React.createElement('polygon', { points: '22,3 2,3 10,12.46 10,19 14,21 14,12.46' })
            ),
            Search: () => React.createElement('svg', { width: 20, height: 20, viewBox: '0 0 24 24', fill: 'none', stroke: 'currentColor', strokeWidth: 2 },
                React.createElement('circle', { cx: 11, cy: 11, r: 8 }),
                React.createElement('path', { d: 'm21 21-4.35-4.35' })
            ),
            ExternalLink: () => React.createElement('svg', { width: 16, height: 16, viewBox: '0 0 24 24', fill: 'none', stroke: 'currentColor', strokeWidth: 2 },
                React.createElement('path', { d: '18 13v6a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V8a2 2 0 0 1 2-2h6' }),
                React.createElement('polyline', { points: '15,3 21,3 21,9' }),
                React.createElement('line', { x1: 10, y1: 14, x2: 21, y2: 3 })
            ),
            RefreshCw: ({ className }) => React.createElement('svg', { 
                width: 16, height: 16, viewBox: '0 0 24 24', fill: 'none', stroke: 'currentColor', strokeWidth: 2,
                className: className
            },
                React.createElement('polyline', { points: '23,4 23,10 17,10' }),
                React.createElement('polyline', { points: '1,20 1,14 7,14' }),
                React.createElement('path', { d: '20.49 9A9 9 0 0 0 5.64 5.64L1 10m22 4a9 9 0 0 1-14.85 4.36L23 14' })
            )
        };
    </script>
</head>
<body>
    <div id="root"></div>
    
    <script type="text/babel">
        const { useState, useEffect } = React;

        const MenuPlanner = () => {
            const [dietaryRestrictions, setDietaryRestrictions] = useState([]);
            const [budget, setBudget] = useState('');
            const [numAdults, setNumAdults] = useState(2);
            const [numKids, setNumKids] = useState(0);
            const [deals, setDeals] = useState([]);
            const [menuPlan, setMenuPlan] = useState({});
            const [ingredients, setIngredients] = useState([]);
            const [recipes, setRecipes] = useState([]);
            const [loading, setLoading] = useState(false);
            const [newDeal, setNewDeal] = useState({ item: '', price: '', originalPrice: '' });

            const commonRestrictions = [
                'Vegetarian', 'Vegan', 'Gluten-Free', 'Dairy-Free', 'Nut-Free', 
                'Low-Carb', 'Keto', 'Paleo', 'Low-Sodium', 'Diabetic-Friendly', 'Flexitarian'
            ];

            const stores = [
                { name: 'Walmart', api: 'walmart', supported: true },
                { name: 'Target', api: 'target', supported: true },
                { name: 'Kroger', api: 'kroger', supported: true },
                { name: 'Publix', api: 'publix', supported: true },
                { name: 'Safeway', api: 'safeway', supported: false },
                { name: 'Whole Foods', api: 'wholefoods', supported: false }
            ];

            // Auto-fetch recipes when dietary restrictions change
            useEffect(() => {
                fetchRecipes();
            }, [dietaryRestrictions]);

            // Also fetch initial recipes on component mount
            useEffect(() => {
                fetchRecipes();
            }, []);

            const addDietaryRestriction = (restriction) => {
                if (!dietaryRestrictions.includes(restriction)) {
                    setDietaryRestrictions([...dietaryRestrictions, restriction]);
                }
            };

            const removeDietaryRestriction = (restriction) => {
                setDietaryRestrictions(dietaryRestrictions.filter(r => r !== restriction));
            };

            const addDeal = () => {
                if (newDeal.item && newDeal.price) {
                    setDeals([...deals, { ...newDeal, id: Date.now() }]);
                    setNewDeal({ item: '', price: '', originalPrice: '' });
                }
            };

            const removeDeal = (id) => {
                setDeals(deals.filter(deal => deal.id !== id));
            };

            // Replace your fetchRecipes function with this:
const fetchRecipes = async () => {
  setLoading(true);
  
  try {
    let allRecipes = [];
    
    if (dietaryRestrictions.length > 0) {
      const hasVegetarian = dietaryRestrictions.includes('Vegetarian');
      const hasVegan = dietaryRestrictions.includes('Vegan');
      const hasFlexitarian = dietaryRestrictions.includes('Flexitarian');
      
      // TheMealDB API calls based on dietary restrictions
      if (hasVegan || hasVegetarian) {
        // Get vegetarian meals
        const vegResponse = await fetch('https://www.themealdb.com/api/json/v1/1/filter.php?c=Vegetarian');
        const vegData = await vegResponse.json();
        if (vegData.meals) {
          allRecipes = [...allRecipes, ...vegData.meals.slice(0, 10)];
        }
      }
      
      if (hasFlexitarian || (!hasVegetarian && !hasVegan)) {
        // Get chicken meals for flexitarian/omnivores
        const chickenResponse = await fetch('https://www.themealdb.com/api/json/v1/1/filter.php?i=chicken');
        const chickenData = await chickenResponse.json();
        if (chickenData.meals) {
          allRecipes = [...allRecipes, ...chickenData.meals.slice(0, 8)];
        }
        
        // Get beef meals
        const beefResponse = await fetch('https://www.themealdb.com/api/json/v1/1/filter.php?i=beef');
        const beefData = await beefResponse.json();
        if (beefData.meals) {
          allRecipes = [...allRecipes, ...beefData.meals.slice(0, 5)];
        }
      }
      
      // Add seafood for non-vegetarian diets
      if (hasFlexitarian || (!hasVegetarian && !hasVegan)) {
        const seafoodResponse = await fetch('https://www.themealdb.com/api/json/v1/1/filter.php?c=Seafood');
        const seafoodData = await seafoodResponse.json();
        if (seafoodData.meals) {
          allRecipes = [...allRecipes, ...seafoodData.meals.slice(0, 5)];
        }
      }
    } else {
      // No dietary restrictions - get variety
      const categories = ['Chicken', 'Beef', 'Seafood', 'Vegetarian', 'Pasta'];
      
      for (const category of categories) {
        try {
          const response = await fetch(`https://www.themealdb.com/api/json/v1/1/filter.php?c=${category}`);
          const data = await response.json();
          if (data.meals) {
            allRecipes = [...allRecipes, ...data.meals.slice(0, 4)];
          }
        } catch (error) {
          console.error(`Error fetching ${category}:`, error);
        }
      }
    }
    
    // Transform TheMealDB format to your app's format
    const transformedRecipes = await Promise.all(
      allRecipes.slice(0, 25).map(async (meal) => {
        try {
          // Get detailed recipe info
          const detailResponse = await fetch(`https://www.themealdb.com/api/json/v1/1/lookup.php?i=${meal.idMeal}`);
          const detailData = await detailResponse.json();
          const fullMeal = detailData.meals[0];
          
          // Extract ingredients
          const ingredients = [];
          for (let i = 1; i <= 20; i++) {
            const ingredient = fullMeal[`strIngredient${i}`];
            if (ingredient && ingredient.trim()) {
              ingredients.push(ingredient.trim().toLowerCase());
            }
          }
          
          // Estimate cost based on ingredients (simple algorithm)
          const estimatedCost = Math.max(8, Math.min(25, ingredients.length * 2 + Math.random() * 5));
          
          // Determine dietary tags
          const dietaryTags = [];
          if (fullMeal.strCategory === 'Vegetarian') dietaryTags.push('vegetarian');
          if (!ingredients.some(ing => ['chicken', 'beef', 'pork', 'fish', 'meat'].includes(ing))) {
            dietaryTags.push('vegetarian');
          }
          if (!ingredients.some(ing => ['cheese', 'milk', 'cream', 'butter', 'egg'].includes(ing)) && 
              dietaryTags.includes('vegetarian')) {
            dietaryTags.push('vegan');
          }
          dietaryTags.push('flexitarian');
          
          return {
            name: fullMeal.strMeal,
            ingredients: ingredients.slice(0, 8), // Limit to 8 main ingredients
            cookTime: 30 + Math.floor(Math.random() * 30), // Estimate 30-60 mins
            servings: 4,
            difficulty: ['Easy', 'Medium'][Math.floor(Math.random() * 2)],
            url: fullMeal.strSource || `https://www.themealdb.com/meal/${meal.idMeal}`,
            estimatedCost: Math.round(estimatedCost),
            dietaryTags: dietaryTags,
            image: fullMeal.strMealThumb
          };
        } catch (error) {
          console.error('Error processing meal:', error);
          return null;
        }
      })
    );
    
    // Filter out any failed transformations and remove duplicates
    const validRecipes = transformedRecipes
      .filter(recipe => recipe !== null)
      .filter((recipe, index, self) => 
        index === self.findIndex(r => r.name === recipe.name)
      );
    
    setRecipes(validRecipes);
    
  } catch (error) {
    console.error('Error fetching recipes from TheMealDB:', error);
    // Fallback to your existing sample data
    setRecipes(sampleRecipes['Default'] || []);
  }
  
  setLoading(false);
};

            const fetchStoreDeals = async (store) => {
                if (loading) return; // Prevent multiple simultaneous calls
                setLoading(true);
                try {
                    await new Promise(resolve => setTimeout(resolve, 2000));
                
                const sampleDeals = {
                    walmart: [
                        { item: 'Chicken Breast (2lb)', price: '5.99', originalPrice: '7.99' },
                        { item: 'Rice (5lb bag)', price: '2.99', originalPrice: '4.99' },
                        { item: 'Mixed Vegetables (frozen)', price: '1.49', originalPrice: '2.49' }
                    ],
                    target: [
                        { item: 'Quinoa (1lb)', price: '3.99', originalPrice: '5.99' },
                        { item: 'Olive Oil', price: '4.99', originalPrice: '6.99' },
                        { item: 'Coconut Milk', price: '1.99', originalPrice: '2.99' }
                    ],
                    kroger: [
                        { item: 'Ground Beef (1lb)', price: '4.99', originalPrice: '6.99' },
                        { item: 'Pasta', price: '0.99', originalPrice: '1.99' },
                        { item: 'Tomato Sauce', price: '0.79', originalPrice: '1.29' }
                    ],
                    publix: [
                        { item: 'Pub Sub (Whole)', price: '5.99', originalPrice: '8.99' },
                        { item: 'Fresh Salmon (1lb)', price: '7.99', originalPrice: '10.99' },
                        { item: 'Publix Brand Cereal', price: '2.49', originalPrice: '3.99' },
                        { item: 'Boars Head Deli Meat (1lb)', price: '6.99', originalPrice: '9.99' }
                    ]
                };
                
                const fetchedDeals = sampleDeals[store] || [];
                const dealsWithIds = fetchedDeals.map(deal => ({ ...deal, id: Date.now() + Math.random() }));
                
                setDeals([...deals, ...dealsWithIds]);
                } catch (error) {
                    console.error('Error fetching deals:', error);
                } finally {
                setLoading(false);
                }
            };

            const generateMenuPlan = () => {
                  console.log('Generate menu clicked!');
                  console.log('Recipes available:', recipes.length);
                      // Don't auto-fetch if no recipes - just show an alert
                if (recipes.length === 0) {
                     alert('No recipes loaded yet. Please wait for recipes to load automatically, or try refreshing the page.');
                    return;
                    //fetchRecipes().then(() => {
                      //  setTimeout(() => generateMenuPlan(), 500);
                }
                
                const weeklyBudget = parseFloat(budget) || 100;
                const totalPeople = numAdults + numKids;
                const servingMultiplier = Math.max(1, totalPeople / 4);
                const adjustedBudget = weeklyBudget * servingMultiplier;
                const dailyBudget = adjustedBudget / 7;
                
                const daysOfWeek = ['Monday', 'Tuesday', 'Wednesday', 'Thursday', 'Friday', 'Saturday', 'Sunday'];
                
                let newMenuPlan = {};
                let allIngredients = [];

                daysOfWeek.forEach(day => {
                    const suitableRecipes = recipes.filter(recipe => {
                        const scaledCost = (recipe.estimatedCost * servingMultiplier);
                        return scaledCost <= dailyBudget * 1.5;
                    });
                    
                    if (suitableRecipes.length > 0) {
                        const selectedRecipe = suitableRecipes[Math.floor(Math.random() * suitableRecipes.length)];
                        
                        let scaledCost = selectedRecipe.estimatedCost * servingMultiplier;
                        let scaledServings = Math.ceil(selectedRecipe.servings * servingMultiplier);
                        
                        selectedRecipe.ingredients.forEach(ingredient => {
                            const deal = deals.find(d => 
                                d.item.toLowerCase().includes(ingredient.toLowerCase()) || 
                                ingredient.toLowerCase().includes(d.item.toLowerCase().split(' ')[0])
                            );
                            if (deal) {
                                const savings = (parseFloat(deal.originalPrice) - parseFloat(deal.price)) || 0;
                                scaledCost -= Math.min(savings * servingMultiplier, scaledCost * 0.2);
                            }
                        });

                        newMenuPlan[day] = {
                            ...selectedRecipe,
                            originalCost: selectedRecipe.estimatedCost,
                            scaledCost: Math.max(scaledCost, selectedRecipe.estimatedCost * servingMultiplier * 0.6),
                            scaledServings: scaledServings,
                            servingMultiplier: servingMultiplier
                        };
                        
                        allIngredients = [...allIngredients, ...selectedRecipe.ingredients];
                    }
                });

                setMenuPlan(newMenuPlan);
                setIngredients([...new Set(allIngredients)]);
            };

            const getTotalCost = () => {
                return Object.values(menuPlan).reduce((total, meal) => total + (meal.scaledCost || meal.adjustedCost || meal.estimatedCost), 0);
            };

            return (
                <div className="max-w-7xl mx-auto p-6 bg-gradient-to-br from-green-50 to-blue-50 min-h-screen">
                    <div className="bg-white rounded-lg shadow-lg p-8">
                        <h1 className="text-3xl font-bold text-gray-800 mb-8 text-center">
                            üçΩÔ∏è Smart Menu Planner with Recipe Search
                        </h1>

                        {/* Dietary Restrictions Section */}
                        <div className="mb-8">
                            <h2 className="text-xl font-semibold mb-4 flex items-center">
                                <Icons.Filter />
                                <span className="ml-2">Dietary Restrictions</span>
                            </h2>
                            <div className="flex flex-wrap gap-2 mb-4">
                                {commonRestrictions.map(restriction => (
                                    <button
                                        key={restriction}
                                        onClick={() => addDietaryRestriction(restriction)}
                                        className={`px-3 py-1 rounded-full text-sm transition-colors ${
                                            dietaryRestrictions.includes(restriction)
                                                ? 'bg-green-500 text-white'
                                                : 'bg-gray-200 text-gray-700 hover:bg-gray-300'
                                        }`}
                                    >
                                        {restriction}
                                    </button>
                                ))}
                            </div>
                            <div className="flex flex-wrap gap-2">
                                {dietaryRestrictions.map(restriction => (
                                    <span
                                        key={restriction}
                                        className="bg-green-100 text-green-800 px-3 py-1 rounded-full text-sm flex items-center"
                                    >
                                        {restriction}
                                        <button
                                            onClick={() => removeDietaryRestriction(restriction)}
                                            className="ml-2 text-green-600 hover:text-green-800"
                                        >
                                            <Icons.X />
                                        </button>
                                    </span>
                                ))}
                            </div>
                        </div>

                        {/* Recipe Section */}
                        <div className="mb-8">
                            <h2 className="text-xl font-semibold mb-4 flex items-center">
                                <Icons.Search />
                                <span className="ml-2">Recipe Database</span>
                            </h2>
                            <div className="bg-blue-50 border border-blue-200 rounded-lg p-4 mb-4">
                                <p className="text-sm text-blue-700 mb-3">
                                    üåê <strong>Recipe Database:</strong> {recipes.length} recipes loaded automatically based on your dietary restrictions.
                                    {loading && <span className="ml-2">‚è≥ Updating recipes...</span>}
                                </p>
                            </div>
                            
                            {recipes.length > 0 && (
                                <div className="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4">
                                    {recipes.slice(0, 6).map((recipe, index) => (
                                        <div key={index} className="bg-white border border-gray-200 rounded-lg p-4 shadow-sm">
                                            <h3 className="font-semibold mb-2">{recipe.name}</h3>
                                            <div className="text-sm text-gray-600 mb-2">
                                                ‚è±Ô∏è {recipe.cookTime} min | üçΩÔ∏è {recipe.servings} servings | üìä {recipe.difficulty}
                                            </div>
                                            <div className="text-sm text-gray-600 mb-2">
                                                <strong>Ingredients:</strong> {recipe.ingredients.slice(0, 3).join(', ')}
                                                {recipe.ingredients.length > 3 && '...'}
                                            </div>
                                            <div className="flex justify-between items-center mb-2">
                                                <span className="text-green-600 font-semibold">${recipe.estimatedCost}</span>
                                                <a href={recipe.url} target="_blank" rel="noopener noreferrer" 
                                                   className="text-blue-500 hover:text-blue-700">
                                                    <Icons.ExternalLink />
                                                </a>
                                            </div>
                                            {recipe.dietaryTags && (
                                                <div className="flex flex-wrap gap-1">
                                                    {recipe.dietaryTags.map(tag => (
                                                        <span key={tag} className="text-xs bg-gray-100 text-gray-600 px-2 py-1 rounded">
                                                            {tag}
                                                        </span>
                                                    ))}
                                                </div>
                                            )}
                                        </div>
                                    ))}
                                </div>
                            )}
                        </div>

                        {/* Budget and People Section */}
                        <div className="mb-8 grid grid-cols-1 md:grid-cols-2 gap-6">
                            <div>
                                <h2 className="text-xl font-semibold mb-4 flex items-center">
                                    <Icons.DollarSign />
                                    <span className="ml-2">Weekly Budget</span>
                                </h2>
                                <input
                                    type="number"
                                    value={budget}
                                    onChange={(e) => setBudget(e.target.value)}
                                    placeholder="Enter weekly food budget"
                                    className="w-full px-3 py-2 border border-gray-300 rounded-md"
                                />
                            </div>
                            
                            <div>
                                <h2 className="text-xl font-semibold mb-4 flex items-center">
                                    <span className="mr-2">üë•</span>Number of People
                                </h2>
                                <div className="grid grid-cols-2 gap-3">
                                    <div>
                                        <label className="block text-sm font-medium text-gray-700 mb-1">Adults</label>
                                        <input
                                            type="number"
                                            min="1"
                                            value={numAdults}
                                            onChange={(e) => setNumAdults(parseInt(e.target.value) || 1)}
                                            className="w-full px-3 py-2 border border-gray-300 rounded-md"
                                        />
                                    </div>
                                    <div>
                                        <label className="block text-sm font-medium text-gray-700 mb-1">Kids</label>
                                        <input
                                            type="number"
                                            min="0"
                                            value={numKids}
                                            onChange={(e) => setNumKids(parseInt(e.target.value) || 0)}
                                            className="w-full px-3 py-2 border border-gray-300 rounded-md"
                                        />
                                    </div>
                                </div>
                                <p className="text-sm text-gray-600 mt-2">
                                    Total: {numAdults + numKids} people
                                </p>
                            </div>
                        </div>

                        {/* Store Integration Section */}
                        <div className="mb-8">
                            <h2 className="text-xl font-semibold mb-4 flex items-center">
                                <Icons.ShoppingCart />
                                <span className="ml-2">Grocery Store Deals</span>
                            </h2>
                            
                            <div className="bg-yellow-50 border border-yellow-200 rounded-lg p-4 mb-4">
                                <p className="text-sm text-yellow-700 mb-3">
                                    üè™ <strong>Auto-Deal Fetching:</strong> Connect to store APIs to automatically pull weekly deals.
                                    <br />‚Ä¢ <strong>Publix Integration:</strong> Weekly ad data available from publix.com/savings/weekly-ad
                                    <br />‚Ä¢ <strong>Implementation:</strong> Can scrape weekly flyers or use third-party services like Instacart API
                                </p>
                                <div className="flex flex-wrap gap-2 mb-3">
                                    {stores.map(store => (
                                        <button
                                            key={store.api}
                                            onClick={() => store.supported && fetchStoreDeals(store.api)}
                                            disabled={!store.supported || loading}
                                            className={`px-3 py-1 rounded text-sm ${
                                                store.supported 
                                                    ? 'bg-green-500 text-white hover:bg-green-600 disabled:opacity-50' 
                                                    : 'bg-gray-300 text-gray-500 cursor-not-allowed'
                                            }`}
                                        >
                                            {store.name} {!store.supported && '(Coming Soon)'}
                                        </button>
                                    ))}
                                </div>
                                {loading && (
                                    <div className="flex items-center text-blue-600">
                                        <Icons.RefreshCw className="mr-2 animate-spin" />
                                        Fetching store deals...
                                    </div>
                                )}
                            </div>

                            {/* Manual Deal Entry */}
                            <div className="grid grid-cols-1 md:grid-cols-3 gap-4 mb-4">
                                <input
                                    type="text"
                                    value={newDeal.item}
                                    onChange={(e) => setNewDeal({...newDeal, item: e.target.value})}
                                    placeholder="Item name"
                                    className="px-3 py-2 border border-gray-300 rounded-md"
                                />
                                <input
                                    type="number"
                                    step="0.01"
                                    value={newDeal.price}
                                    onChange={(e) => setNewDeal({...newDeal, price: e.target.value})}
                                    placeholder="Sale price"
                                    className="px-3 py-2 border border-gray-300 rounded-md"
                                />
                                <input
                                    type="number"
                                    step="0.01"
                                    value={newDeal.originalPrice}
                                    onChange={(e) => setNewDeal({...newDeal, originalPrice: e.target.value})}
                                    placeholder="Original price"
                                    className="px-3 py-2 border border-gray-300 rounded-md"
                                />
                            </div>
                            <button
                                onClick={addDeal}
                                className="mb-4 px-4 py-2 bg-green-500 text-white rounded-md hover:bg-green-600 flex items-center"
                            >
                                <Icons.Plus />
                                <span className="ml-2">Add Manual Deal</span>
                            </button>

                            <div className="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-3">
                                {deals.map(deal => (
                                    <div key={deal.id} className="bg-yellow-50 border border-yellow-200 rounded-md p-3 flex justify-between items-center">
                                        <div>
                                            <div className="font-medium">{deal.item}</div>
                                            <div className="text-sm text-gray-600">
                                                ${deal.price}
                                                {deal.originalPrice && (
                                                    <span className="ml-2 line-through text-red-500">
                                                        ${deal.originalPrice}
                                                    </span>
                                                )}
                                            </div>
                                        </div>
                                        <button
                                            onClick={() => removeDeal(deal.id)}
                                            className="text-red-500 hover:text-red-700"
                                        >
                                            <Icons.X />
                                        </button>
                                    </div>
                                ))}
                            </div>
                        </div>

                        {/* Generate Menu Button */}
                        <div className="text-center mb-8">
                            <button
                                onClick={generateMenuPlan}
                                className="px-8 py-3 bg-blue-600 text-white rounded-lg hover:bg-blue-700 font-semibold text-lg flex items-center mx-auto"
                            >
                                <Icons.Calendar />
                                <span className="ml-2">Generate Weekly Menu</span>
                            </button>
                        </div>

                        {/* Menu Plan Display */}
                        {Object.keys(menuPlan).length > 0 && (
                            <div className="mb-8">
                                <h2 className="text-xl font-semibold mb-4">Your Weekly Menu Plan</h2>
                                <div className="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4 mb-6">
                                    {Object.entries(menuPlan).map(([day, meal]) => (
                                        <div key={day} className="bg-gradient-to-br from-blue-50 to-purple-50 border border-blue-200 rounded-lg p-4">
                                            <h3 className="font-semibold text-lg mb-2">{day}</h3>
                                            <h4 className="font-medium text-blue-700 mb-2 flex items-center">
                                                {meal.name}
                                                <a href={meal.url} target="_blank" rel="noopener noreferrer" 
                                                   className="ml-2 text-blue-500 hover:text-blue-700">
                                                    <Icons.ExternalLink />
                                                </a>
                                            </h4>
                                            <div className="text-sm text-gray-600 mb-2">
                                                ‚è±Ô∏è {meal.cookTime} min | üçΩÔ∏è {meal.scaledServings || meal.servings} servings
                                                {meal.servingMultiplier > 1 && (
                                                    <span className="text-blue-600"> (scaled for {numAdults + numKids} people)</span>
                                                )}
                                            </div>
                                            <div className="text-sm text-gray-600 mb-2">
                                                <strong>Ingredients:</strong> {meal.ingredients.join(', ')}
                                            </div>
                                            <div className="text-sm font-medium text-green-600">
                                                Cost: ${meal.scaledCost?.toFixed(2) || meal.adjustedCost?.toFixed(2) || meal.estimatedCost?.toFixed(2)}
                                                {meal.originalCost && meal.scaledCost !== meal.originalCost && (
                                                    <span className="text-xs text-gray-500 ml-1">
                                                        (was ${meal.originalCost.toFixed(2)})
                                                    </span>
                                                )}
                                            </div>
                                        </div>
                                    ))}
                                </div>
                                
                                <div className="bg-green-100 border border-green-300 rounded-lg p-4 mb-6">
                                    <h3 className="font-semibold text-lg mb-2">Budget Summary</h3>
                                    <div className="grid grid-cols-2 md:grid-cols-4 gap-4">
                                        <div>
                                            <span className="text-gray-600">People:</span>
                                            <span className="font-semibold ml-2">{numAdults + numKids}</span>
                                        </div>
                                        <div>
                                            <span className="text-gray-600">Weekly Budget:</span>
                                            <span className="font-semibold ml-2">${budget || '100'}</span>
                                        </div>
                                        <div>
                                            <span className="text-gray-600">Estimated Total:</span>
                                            <span className="font-semibold ml-2">${getTotalCost().toFixed(2)}</span>
                                        </div>
                                        <div>
                                            <span className="text-gray-600">Per Person:</span>
                                            <span className="font-semibold ml-2">${(getTotalCost() / (numAdults + numKids)).toFixed(2)}</span>
                                        </div>
                                    </div>
                                    <div className="mt-2">
                                        <span className="text-gray-600">Remaining Budget:</span>
                                        <span className={`font-semibold ml-2 ${
                                            (parseFloat(budget) || 100) - getTotalCost() >= 0 ? 'text-green-600' : 'text-red-600'
                                        }`}>
                                            ${((parseFloat(budget) || 100) - getTotalCost()).toFixed(2)}
                                        </span>
                                    </div>
                                </div>

                                <div className="bg-blue-50 border border-blue-200 rounded-lg p-4">
                                    <h3 className="font-semibold text-lg mb-2">Shopping List</h3>
                                    <div className="grid grid-cols-2 md:grid-cols-3 lg:grid-cols-4 gap-2">
                                        {ingredients.map((ingredient, index) => (
                                            <div key={index} className="bg-white rounded px-3 py-1 text-sm border">
                                                {ingredient}
                                                {deals.some(deal => 
                                                    deal.item.toLowerCase().includes(ingredient.toLowerCase()) ||
                                                    ingredient.toLowerCase().includes(deal.item.toLowerCase().split(' ')[0])
                                                ) && (
                                                    <span className="ml-1 text-green-600 font-bold">üè∑Ô∏è</span>
                                                )}
                                            </div>
                                        ))}
                                    </div>
                                </div>
                            </div>
                        )}
                    </div>
                </div>
            );
        };

        ReactDOM.render(React.createElement(MenuPlanner), document.getElementById('root'));
    </script>
</body>
</html>
                                            
